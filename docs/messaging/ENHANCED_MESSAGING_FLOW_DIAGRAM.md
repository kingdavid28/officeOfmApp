# Enhanced Messaging System - Flow Diagram

## ğŸ“Š Complete System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ENHANCED MESSAGING SYSTEM                        â”‚
â”‚                     (Organization Messaging)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER INTERFACE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              MessagingPage.tsx Component                     â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚ â”‚
â”‚  â”‚  â”‚   Chat     â”‚  â”‚Notificationsâ”‚  â”‚   Header   â”‚           â”‚ â”‚
â”‚  â”‚  â”‚    Tab     â”‚  â”‚    Tab      â”‚  â”‚   Tabs     â”‚           â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚           Message Display Area                       â”‚  â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Message Bubbles                                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ File Attachments (ğŸ“)                            â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Image Previews (ğŸ–¼ï¸)                              â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Reactions (ğŸ˜Š ğŸ‘ â¤ï¸)                             â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Typing Indicators (âŒ¨ï¸)                           â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Edit/Delete Buttons                               â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚           Upload Progress Bar                        â”‚  â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚ â”‚
â”‚  â”‚  â”‚  ğŸ“¤ Uploading... [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] 80%                   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  ğŸ“„ document.pdf                                     â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚           Message Input Area                         â”‚  â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚ â”‚
â”‚  â”‚  â”‚  [ğŸ“] [Type message...              ] [Send â¤]      â”‚  â”‚ â”‚
â”‚  â”‚  â”‚   â†‘                                        â†‘          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  File                                    Send         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  Upload                                 Button        â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â”‚ Uses
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         REACT HOOKS LAYER                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              useMessages Hook                                â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  State:                                                      â”‚ â”‚
â”‚  â”‚  â€¢ messages: Message[]                                       â”‚ â”‚
â”‚  â”‚  â€¢ loading: boolean                                          â”‚ â”‚
â”‚  â”‚  â€¢ uploadProgress: UploadProgress | null                     â”‚ â”‚
â”‚  â”‚  â€¢ typingUsers: { userId, userName }[]                       â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Methods:                                                    â”‚ â”‚
â”‚  â”‚  â€¢ sendMessage(content, senderId, senderName)                â”‚ â”‚
â”‚  â”‚  â€¢ sendFileMessage(file, senderId, senderName, caption)      â”‚ â”‚
â”‚  â”‚  â€¢ editMessage(messageId, newContent)                        â”‚ â”‚
â”‚  â”‚  â€¢ deleteMessage(messageId)                                  â”‚ â”‚
â”‚  â”‚  â€¢ addReaction(messageId, userId, emoji)                     â”‚ â”‚
â”‚  â”‚  â€¢ removeReaction(messageId, userId)                         â”‚ â”‚
â”‚  â”‚  â€¢ setTyping(userId, userName, isTyping)                     â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              useNotifications Hook                           â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  â€¢ notifications: Notification[]                             â”‚ â”‚
â”‚  â”‚  â€¢ unreadCount: number                                       â”‚ â”‚
â”‚  â”‚  â€¢ markAsRead(notificationId)                                â”‚ â”‚
â”‚  â”‚  â€¢ markAllAsRead()                                           â”‚ â”‚
â”‚  â”‚  â€¢ deleteNotification(notificationId)                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â”‚ Calls
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       SERVICE LAYER                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              MessagingService                                â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  sendMessage()                                               â”‚ â”‚
â”‚  â”‚  â”œâ”€ Validate input                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ Create message object                                    â”‚ â”‚
â”‚  â”‚  â”œâ”€ Push to Realtime Database                                â”‚ â”‚
â”‚  â”‚  â””â”€ Create notification                                      â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  sendFileMessage()                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ Validate file (type, size)                               â”‚ â”‚
â”‚  â”‚  â”œâ”€ Upload to Firebase Storage                               â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€ Track progress (0-100%)                               â”‚ â”‚
â”‚  â”‚  â”œâ”€ Get download URL                                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ Send message with file URL                               â”‚ â”‚
â”‚  â”‚  â””â”€ Create notification                                      â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  subscribeToMessages()                                       â”‚ â”‚
â”‚  â”‚  â”œâ”€ Listen to onChildAdded                                   â”‚ â”‚
â”‚  â”‚  â”œâ”€ Listen to onChildChanged                                 â”‚ â”‚
â”‚  â”‚  â””â”€ Return unsubscribe function                              â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  addReaction()                                               â”‚ â”‚
â”‚  â”‚  â”œâ”€ Set reaction in database                                 â”‚ â”‚
â”‚  â”‚  â””â”€ Update message reactions                                 â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  setTyping()                                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€ Set typing indicator                                     â”‚ â”‚
â”‚  â”‚  â””â”€ Auto-remove after 3 seconds                              â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  listenToTyping()                                            â”‚ â”‚
â”‚  â”‚  â”œâ”€ Listen to typing path                                    â”‚ â”‚
â”‚  â”‚  â””â”€ Return typing users array                                â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              NotificationService                             â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  â€¢ createNotification()                                      â”‚ â”‚
â”‚  â”‚  â€¢ subscribeToNotifications()                                â”‚ â”‚
â”‚  â”‚  â€¢ markAsRead()                                              â”‚ â”‚
â”‚  â”‚  â€¢ markAllAsRead()                                           â”‚ â”‚
â”‚  â”‚  â€¢ deleteNotification()                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â”‚ Interacts with
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       FIREBASE LAYER                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚         Firebase Realtime Database                           â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  organizations/{orgId}/                                      â”‚ â”‚
â”‚  â”‚    â”œâ”€ messages/                                              â”‚ â”‚
â”‚  â”‚    â”‚   â””â”€ {messageId}/                                       â”‚ â”‚
â”‚  â”‚    â”‚       â”œâ”€ id: string                                     â”‚ â”‚
â”‚  â”‚    â”‚       â”œâ”€ content: string                                â”‚ â”‚
â”‚  â”‚    â”‚       â”œâ”€ senderId: string                               â”‚ â”‚
â”‚  â”‚    â”‚       â”œâ”€ senderName: string                             â”‚ â”‚
â”‚  â”‚    â”‚       â”œâ”€ timestamp: number                              â”‚ â”‚
â”‚  â”‚    â”‚       â”œâ”€ type: 'text' | 'file'                          â”‚ â”‚
â”‚  â”‚    â”‚       â”œâ”€ fileUrl?: string                               â”‚ â”‚
â”‚  â”‚    â”‚       â”œâ”€ fileName?: string                              â”‚ â”‚
â”‚  â”‚    â”‚       â”œâ”€ edited: boolean                                â”‚ â”‚
â”‚  â”‚    â”‚       â””â”€ reactions: { [userId]: emoji }                 â”‚ â”‚
â”‚  â”‚    â”‚                                                          â”‚ â”‚
â”‚  â”‚    â”œâ”€ typing/                                                â”‚ â”‚
â”‚  â”‚    â”‚   â””â”€ {userId}/                                          â”‚ â”‚
â”‚  â”‚    â”‚       â”œâ”€ userId: string                                 â”‚ â”‚
â”‚  â”‚    â”‚       â”œâ”€ userName: string                               â”‚ â”‚
â”‚  â”‚    â”‚       â”œâ”€ isTyping: boolean                              â”‚ â”‚
â”‚  â”‚    â”‚       â””â”€ timestamp: number                              â”‚ â”‚
â”‚  â”‚    â”‚                                                          â”‚ â”‚
â”‚  â”‚    â””â”€ notifications/                                         â”‚ â”‚
â”‚  â”‚        â””â”€ {notificationId}/                                  â”‚ â”‚
â”‚  â”‚            â”œâ”€ id: string                                     â”‚ â”‚
â”‚  â”‚            â”œâ”€ title: string                                  â”‚ â”‚
â”‚  â”‚            â”œâ”€ message: string                                â”‚ â”‚
â”‚  â”‚            â”œâ”€ type: string                                   â”‚ â”‚
â”‚  â”‚            â”œâ”€ read: boolean                                  â”‚ â”‚
â”‚  â”‚            â””â”€ createdAt: number                              â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚         Firebase Storage                                     â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  messages/{orgId}/                                           â”‚ â”‚
â”‚  â”‚    â””â”€ {timestamp}_{filename}                                 â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  Features:                                                   â”‚ â”‚
â”‚  â”‚  â€¢ Upload with progress tracking                             â”‚ â”‚
â”‚  â”‚  â€¢ Download URLs                                             â”‚ â”‚
â”‚  â”‚  â€¢ Automatic cleanup on delete                               â”‚ â”‚
â”‚  â”‚  â€¢ 10MB file size limit                                      â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Message Flow Diagrams

### 1. Send Text Message Flow

```
User Types Message
       â”‚
       â–¼
[Type message...] â”€â”€onChangeâ”€â”€> handleTyping()
       â”‚                              â”‚
       â”‚                              â–¼
       â”‚                        setTyping(true)
       â”‚                              â”‚
       â”‚                              â–¼
       â”‚                    Realtime Database
       â”‚                    typing/{userId}
       â”‚
       â–¼
Click [Send] â”€â”€onSubmitâ”€â”€> handleSendMessage()
       â”‚                              â”‚
       â”‚                              â–¼
       â”‚                        sendMessage()
       â”‚                              â”‚
       â”‚                              â”œâ”€> Validate input
       â”‚                              â”‚
       â”‚                              â”œâ”€> Create message object
       â”‚                              â”‚
       â”‚                              â”œâ”€> Push to Realtime DB
       â”‚                              â”‚   organizations/{orgId}/messages
       â”‚                              â”‚
       â”‚                              â”œâ”€> Create notification
       â”‚                              â”‚
       â”‚                              â””â”€> setTyping(false)
       â”‚
       â–¼
Message appears in chat (real-time)
       â”‚
       â–¼
Other users see message instantly (< 100ms)
```

### 2. File Upload Flow

```
User Clicks [ğŸ“]
       â”‚
       â–¼
File Input Opens
       â”‚
       â–¼
User Selects File
       â”‚
       â–¼
handleFileUpload(file)
       â”‚
       â”œâ”€> Validate file type
       â”‚   (images, documents only)
       â”‚
       â”œâ”€> Validate file size
       â”‚   (< 10MB)
       â”‚
       â–¼
sendFileMessage(file, ...)
       â”‚
       â”œâ”€> Create storage reference
       â”‚   messages/{orgId}/{timestamp}_{filename}
       â”‚
       â”œâ”€> Start upload
       â”‚   uploadBytesResumable()
       â”‚
       â”œâ”€> Track progress
       â”‚   â”‚
       â”‚   â”œâ”€> 0% â”€â”€> Show progress bar
       â”‚   â”œâ”€> 25% â”€â”€> Update bar
       â”‚   â”œâ”€> 50% â”€â”€> Update bar
       â”‚   â”œâ”€> 75% â”€â”€> Update bar
       â”‚   â””â”€> 100% â”€â”€> Complete
       â”‚
       â”œâ”€> Get download URL
       â”‚   getDownloadURL()
       â”‚
       â”œâ”€> Send message with file URL
       â”‚   sendMessage(caption, ..., 'file', url, filename)
       â”‚
       â””â”€> Create notification
       â”‚
       â–¼
File message appears in chat
       â”‚
       â”œâ”€> Image preview (if image)
       â””â”€> Download button (all files)
```

### 3. Reaction Flow

```
User Hovers Over Message
       â”‚
       â–¼
Click [ğŸ˜Š] Button
       â”‚
       â–¼
Reaction Picker Opens
       â”‚
       â”œâ”€> ğŸ‘ Thumbs up
       â”œâ”€> â¤ï¸ Heart
       â”œâ”€> ğŸ˜‚ Laughing
       â”œâ”€> ğŸ˜® Surprised
       â”œâ”€> ğŸ˜¢ Sad
       â””â”€> ğŸ‰ Celebration
       â”‚
       â–¼
User Clicks Emoji
       â”‚
       â–¼
handleReaction(messageId, emoji)
       â”‚
       â”œâ”€> Check if already reacted
       â”‚   â”‚
       â”‚   â”œâ”€> Yes: removeReaction()
       â”‚   â”‚          â”‚
       â”‚   â”‚          â””â”€> Remove from DB
       â”‚   â”‚              reactions/{userId}
       â”‚   â”‚
       â”‚   â””â”€> No: addReaction()
       â”‚              â”‚
       â”‚              â””â”€> Add to DB
       â”‚                  reactions/{userId} = emoji
       â”‚
       â–¼
Reaction appears on message (real-time)
       â”‚
       â”œâ”€> Show emoji badge
       â”œâ”€> Show count
       â””â”€> Highlight if user reacted
```

### 4. Typing Indicator Flow

```
User Types in Input
       â”‚
       â–¼
onChange Event
       â”‚
       â–¼
handleTyping()
       â”‚
       â”œâ”€> setTyping(userId, userName, true)
       â”‚   â”‚
       â”‚   â””â”€> Set in Realtime DB
       â”‚       typing/{userId} = { isTyping: true, ... }
       â”‚
       â”œâ”€> Clear existing timeout
       â”‚
       â””â”€> Set new timeout (3 seconds)
           â”‚
           â””â”€> Auto-clear after 3s
               setTyping(userId, userName, false)
       â”‚
       â–¼
Other Users See Typing Indicator
       â”‚
       â”œâ”€> "User is typing..."
       â””â”€> Auto-disappears after 3s
       â”‚
       â–¼
User Sends Message
       â”‚
       â””â”€> setTyping(false) immediately
```

### 5. Real-time Sync Flow

```
User A Sends Message
       â”‚
       â–¼
Push to Realtime Database
organizations/{orgId}/messages/{messageId}
       â”‚
       â–¼
Realtime Database Triggers
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚             â”‚             â”‚             â”‚
       â–¼             â–¼             â–¼             â–¼
   User A        User B        User C        User D
   (Sender)    (Recipient)   (Recipient)   (Recipient)
       â”‚             â”‚             â”‚             â”‚
       â”‚             â”‚             â”‚             â”‚
       â–¼             â–¼             â–¼             â–¼
onChildAdded   onChildAdded   onChildAdded   onChildAdded
  Listener       Listener       Listener       Listener
       â”‚             â”‚             â”‚             â”‚
       â”‚             â”‚             â”‚             â”‚
       â–¼             â–¼             â–¼             â–¼
Update Local   Update Local   Update Local   Update Local
   State          State          State          State
       â”‚             â”‚             â”‚             â”‚
       â”‚             â”‚             â”‚             â”‚
       â–¼             â–¼             â–¼             â–¼
  Re-render      Re-render      Re-render      Re-render
  Component      Component      Component      Component
       â”‚             â”‚             â”‚             â”‚
       â”‚             â”‚             â”‚             â”‚
       â–¼             â–¼             â–¼             â–¼
Message Appears Instantly (< 100ms latency)
```

---

## ğŸ¯ Feature Integration Map

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FEATURE INTEGRATION                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Text Messaging â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚
File Upload â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                         â”‚
Image Preview â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                         â”‚
Reactions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€> MessagingPage.tsx
                         â”‚         â”‚
Typing Indicators â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
                         â”‚         â–¼
Edit Messages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   useMessages Hook
                         â”‚         â”‚
Delete Messages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
                         â”‚         â–¼
Notifications â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   MessagingService
                                   â”‚
                                   â–¼
                          Firebase Realtime DB
                                   â”‚
                                   â–¼
                          Real-time Sync (< 100ms)
```

---

## ğŸ“Š Data Flow Summary

### Upload Progress State Flow

```
Initial State: null
       â”‚
       â–¼
File Selected
       â”‚
       â–¼
{ fileName: 'doc.pdf', progress: 0, status: 'uploading' }
       â”‚
       â–¼
{ fileName: 'doc.pdf', progress: 25, status: 'uploading' }
       â”‚
       â–¼
{ fileName: 'doc.pdf', progress: 50, status: 'uploading' }
       â”‚
       â–¼
{ fileName: 'doc.pdf', progress: 75, status: 'uploading' }
       â”‚
       â–¼
{ fileName: 'doc.pdf', progress: 100, status: 'completed' }
       â”‚
       â–¼
State Reset: null
```

### Typing Users State Flow

```
Initial State: []
       â”‚
       â–¼
User A starts typing
       â”‚
       â–¼
[{ userId: 'A', userName: 'Alice' }]
       â”‚
       â–¼
User B starts typing
       â”‚
       â–¼
[{ userId: 'A', userName: 'Alice' }, { userId: 'B', userName: 'Bob' }]
       â”‚
       â–¼
User A stops typing (3s timeout)
       â”‚
       â–¼
[{ userId: 'B', userName: 'Bob' }]
       â”‚
       â–¼
User B stops typing
       â”‚
       â–¼
[]
```

---

## ğŸ” Security Flow

```
User Action
       â”‚
       â–¼
Frontend Validation
       â”‚
       â”œâ”€> File type check
       â”œâ”€> File size check
       â””â”€> Input sanitization
       â”‚
       â–¼
Firebase Authentication
       â”‚
       â”œâ”€> Verify user is logged in
       â””â”€> Get user ID and token
       â”‚
       â–¼
Realtime Database Rules
       â”‚
       â”œâ”€> Check user belongs to organization
       â”œâ”€> Verify write permissions
       â””â”€> Validate data structure
       â”‚
       â–¼
Storage Rules
       â”‚
       â”œâ”€> Check file size
       â”œâ”€> Verify file type
       â””â”€> Validate path
       â”‚
       â–¼
Action Allowed âœ…
```

---

**Last Updated**: February 5, 2026  
**Version**: 2.0.0
