import React, { useState } from 'react';\nimport { useNotifications } from '../../hooks/useMessaging';\nimport { Notification } from '../../lib/types';\n\ninterface NotificationsPanelProps {\n  userId: string;\n}\n\nconst NotificationsPanel: React.FC<NotificationsPanelProps> = ({ userId }) => {\n  const { notifications, unreadCount, loading, markAsRead, markAllAsRead, deleteNotification } = useNotifications(userId);\n  const [isOpen, setIsOpen] = useState(false);\n\n  const handleNotificationClick = async (notification: Notification) => {\n    if (!notification.read) {\n      await markAsRead(notification.id);\n    }\n    \n    if (notification.actionUrl) {\n      window.location.href = notification.actionUrl;\n    }\n  };\n\n  const getNotificationIcon = (type: string) => {\n    switch (type) {\n      case 'success':\n        return 'âœ…';\n      case 'warning':\n        return 'âš ï¸';\n      case 'error':\n        return 'âŒ';\n      case 'message':\n        return 'ðŸ’¬';\n      default:\n        return 'â„¹ï¸';\n    }\n  };\n\n  const getNotificationColor = (type: string) => {\n    switch (type) {\n      case 'success':\n        return 'border-green-200 bg-green-50';\n      case 'warning':\n        return 'border-yellow-200 bg-yellow-50';\n      case 'error':\n        return 'border-red-200 bg-red-50';\n      case 'message':\n        return 'border-blue-200 bg-blue-50';\n      default:\n        return 'border-gray-200 bg-gray-50';\n    }\n  };\n\n  const formatTime = (date: Date) => {\n    const now = new Date();\n    const diff = now.getTime() - date.getTime();\n    const minutes = Math.floor(diff / 60000);\n    const hours = Math.floor(diff / 3600000);\n    const days = Math.floor(diff / 86400000);\n\n    if (minutes < 1) return 'Just now';\n    if (minutes < 60) return `${minutes}m ago`;\n    if (hours < 24) return `${hours}h ago`;\n    return `${days}d ago`;\n  };\n\n  return (\n    <div className=\"relative\">\n      {/* Notification Bell */}\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"relative p-2 text-gray-600 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-full\"\n      >\n        <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 17h5l-5 5v-5zM11 19H6.414a1 1 0 01-.707-.293L4 17V6a3 3 0 013-3h10a3 3 0 013 3v5\" />\n        </svg>\n        {unreadCount > 0 && (\n          <span className=\"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center\">\n            {unreadCount > 9 ? '9+' : unreadCount}\n          </span>\n        )}\n      </button>\n\n      {/* Notifications Dropdown */}\n      {isOpen && (\n        <div className=\"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50\">\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-4 border-b border-gray-200\">\n            <h3 className=\"text-lg font-semibold text-gray-800\">Notifications</h3>\n            {unreadCount > 0 && (\n              <button\n                onClick={markAllAsRead}\n                className=\"text-sm text-blue-600 hover:text-blue-800\"\n              >\n                Mark all read\n              </button>\n            )}\n          </div>\n\n          {/* Notifications List */}\n          <div className=\"max-h-96 overflow-y-auto\">\n            {loading ? (\n              <div className=\"flex items-center justify-center p-8\">\n                <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"></div>\n              </div>\n            ) : notifications.length === 0 ? (\n              <div className=\"text-center text-gray-500 py-8\">\n                No notifications yet\n              </div>\n            ) : (\n              notifications.map((notification) => (\n                <div\n                  key={notification.id}\n                  className={`p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 transition-colors ${\n                    !notification.read ? 'bg-blue-50' : ''\n                  }`}\n                  onClick={() => handleNotificationClick(notification)}\n                >\n                  <div className=\"flex items-start space-x-3\">\n                    <div className=\"flex-shrink-0 text-lg\">\n                      {getNotificationIcon(notification.type)}\n                    </div>\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-center justify-between\">\n                        <p className={`text-sm font-medium ${\n                          !notification.read ? 'text-gray-900' : 'text-gray-600'\n                        }`}>\n                          {notification.title}\n                        </p>\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            deleteNotification(notification.id);\n                          }}\n                          className=\"text-gray-400 hover:text-gray-600 ml-2\"\n                        >\n                          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                          </svg>\n                        </button>\n                      </div>\n                      <p className=\"text-sm text-gray-500 mt-1\">\n                        {notification.message}\n                      </p>\n                      <p className=\"text-xs text-gray-400 mt-2\">\n                        {formatTime(notification.createdAt)}\n                      </p>\n                    </div>\n                    {!notification.read && (\n                      <div className=\"flex-shrink-0\">\n                        <div className=\"w-2 h-2 bg-blue-600 rounded-full\"></div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              ))\n            )}\n          </div>\n\n          {/* Footer */}\n          {notifications.length > 0 && (\n            <div className=\"p-4 border-t border-gray-200\">\n              <button\n                onClick={() => setIsOpen(false)}\n                className=\"w-full text-center text-sm text-gray-600 hover:text-gray-800\"\n              >\n                Close\n              </button>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Backdrop */}\n      {isOpen && (\n        <div\n          className=\"fixed inset-0 z-40\"\n          onClick={() => setIsOpen(false)}\n        ></div>\n      )}\n    </div>\n  );\n};\n\nexport default NotificationsPanel;