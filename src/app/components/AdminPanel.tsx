import React, { useState, useEffect } from 'react';\nimport { authService, UserProfile, UserRole } from '../../lib/auth';\nimport { organizationService } from '../../lib/organization-service';\nimport { PendingOrganization } from '../../lib/organization-types';\nimport { PendingUser } from '../../lib/types';\n\ninterface AdminPanelProps {\n  currentUserUid: string;\n}\n\nexport const AdminPanel: React.FC<AdminPanelProps> = ({ currentUserUid }) => {\n  const [activeTab, setActiveTab] = useState<'users' | 'organizations'>('users');\n  const [pendingUsers, setPendingUsers] = useState<PendingUser[]>([]);\n  const [pendingOrgs, setPendingOrgs] = useState<PendingOrganization[]>([]);\n  const [allUsers, setAllUsers] = useState<UserProfile[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [processingId, setProcessingId] = useState<string | null>(null);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const [users, orgs, allUsersData] = await Promise.all([\n        authService.getPendingUsers(),\n        organizationService.getPendingOrganizations(),\n        authService.getAllUsers()\n      ]);\n      setPendingUsers(users);\n      setPendingOrgs(orgs);\n      setAllUsers(allUsersData);\n    } catch (error) {\n      console.error('Error loading data:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleApproveUser = async (pendingUserId: string) => {\n    const password = prompt('Enter password for new user:');\n    if (!password) return;\n\n    setProcessingId(pendingUserId);\n    try {\n      await authService.approveUser(pendingUserId, password, currentUserUid);\n      await loadData();\n      alert('User approved successfully');\n    } catch (error) {\n      console.error('Error approving user:', error);\n      alert('Error approving user');\n    } finally {\n      setProcessingId(null);\n    }\n  };\n\n  const handleCreateUser = async () => {\n    const email = prompt('Enter email:');\n    const name = prompt('Enter name:');\n    const password = prompt('Enter password:');\n    const role = prompt('Enter role (admin/staff):') as UserRole;\n    \n    if (!email || !name || !password || !role) return;\n\n    try {\n      await authService.createUser(email, password, name, role, currentUserUid);\n      await loadData();\n      alert('User created successfully');\n    } catch (error) {\n      console.error('Error creating user:', error);\n      alert('Error creating user');\n    }\n  };\n\n  const handleDeleteUser = async (userId: string) => {\n    if (!confirm('Are you sure you want to delete this user?')) return;\n\n    try {\n      await authService.deleteUser(userId, currentUserUid);\n      await loadData();\n      alert('User deleted successfully');\n    } catch (error) {\n      console.error('Error deleting user:', error);\n      alert('Error deleting user');\n    }\n  };\n\n  const handleApproveOrg = async (pendingOrgId: string) => {\n    setProcessingId(pendingOrgId);\n    try {\n      await organizationService.approveOrganization(pendingOrgId, currentUserUid);\n      await loadData();\n      alert('Organization approved successfully');\n    } catch (error) {\n      console.error('Error approving organization:', error);\n      alert('Error approving organization');\n    } finally {\n      setProcessingId(null);\n    }\n  };\n\n  if (loading) return <div>Loading...</div>;\n\n  return (\n    <div className=\"p-6\">\n      <h2 className=\"text-2xl font-bold mb-4\">Admin Panel</h2>\n      \n      <div className=\"mb-6\">\n        <div className=\"flex space-x-4 border-b\">\n          <button\n            onClick={() => setActiveTab('users')}\n            className={`px-4 py-2 ${activeTab === 'users' ? 'border-b-2 border-blue-500' : ''}`}\n          >\n            User Management\n          </button>\n          <button\n            onClick={() => setActiveTab('organizations')}\n            className={`px-4 py-2 ${activeTab === 'organizations' ? 'border-b-2 border-blue-500' : ''}`}\n          >\n            Organization Approvals\n          </button>\n        </div>\n      </div>\n\n      {activeTab === 'users' && (\n        <div className=\"space-y-6\">\n          <div className=\"bg-white rounded-lg shadow\">\n            <div className=\"px-6 py-4 border-b flex justify-between items-center\">\n              <h3 className=\"text-lg font-semibold\">Pending User Approvals</h3>\n              <button\n                onClick={handleCreateUser}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\"\n              >\n                Create User\n              </button>\n            </div>\n            \n            {pendingUsers.length === 0 ? (\n              <div className=\"p-6 text-center text-gray-500\">No pending user requests</div>\n            ) : (\n              <div className=\"divide-y\">\n                {pendingUsers.map((user) => (\n                  <div key={user.id} className=\"p-6 flex items-center justify-between\">\n                    <div>\n                      <div className=\"font-medium\">{user.name}</div>\n                      <div className=\"text-sm text-gray-500\">{user.email}</div>\n                      <div className=\"text-sm text-gray-500\">Role: {user.role}</div>\n                    </div>\n                    <button\n                      onClick={() => handleApproveUser(user.id)}\n                      disabled={processingId === user.id}\n                      className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50\"\n                    >\n                      {processingId === user.id ? 'Processing...' : 'Approve'}\n                    </button>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n\n          <div className=\"bg-white rounded-lg shadow\">\n            <div className=\"px-6 py-4 border-b\">\n              <h3 className=\"text-lg font-semibold\">All Users</h3>\n            </div>\n            <div className=\"divide-y\">\n              {allUsers.map((user) => (\n                <div key={user.uid} className=\"p-6 flex items-center justify-between\">\n                  <div>\n                    <div className=\"font-medium\">{user.name}</div>\n                    <div className=\"text-sm text-gray-500\">{user.email}</div>\n                    <div className=\"text-sm text-gray-500\">Role: {user.role}</div>\n                  </div>\n                  {user.role !== 'super_admin' && (\n                    <button\n                      onClick={() => handleDeleteUser(user.uid)}\n                      className=\"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700\"\n                    >\n                      Delete\n                    </button>\n                  )}\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {activeTab === 'organizations' && (\n        <div className=\"bg-white rounded-lg shadow\">\n          <div className=\"px-6 py-4 border-b\">\n            <h3 className=\"text-lg font-semibold\">Pending Organization Approvals</h3>\n          </div>\n          \n          {pendingOrgs.length === 0 ? (\n            <div className=\"p-6 text-center text-gray-500\">No pending organization requests</div>\n          ) : (\n            <div className=\"divide-y\">\n              {pendingOrgs.map((org) => (\n                <div key={org.id} className=\"p-6 flex items-center justify-between\">\n                  <div>\n                    <div className=\"font-medium\">{org.name}</div>\n                    <div className=\"text-sm text-gray-500\">{org.email}</div>\n                    <div className=\"text-sm text-gray-500\">Contact: {org.contactPerson}</div>\n                    <div className=\"text-sm text-gray-500\">Phone: {org.phone}</div>\n                  </div>\n                  <button\n                    onClick={() => handleApproveOrg(org.id)}\n                    disabled={processingId === org.id}\n                    className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50\"\n                  >\n                    {processingId === org.id ? 'Processing...' : 'Approve'}\n                  </button>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};