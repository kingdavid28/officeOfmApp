# Super Admin Approval System\n\nThis system implements a secure user and admin account creation process that requires approval from a super administrator.\n\n## Features\n\n- **Super Admin Account**: A privileged account that can approve/reject user creation requests\n- **Approval Workflow**: All user and admin accounts must be approved before activation\n- **Secure Setup**: Super admin credentials are configurable via environment variables\n- **Audit Trail**: All approval actions are tracked\n\n## Setup Instructions\n\n### 1. Configure Super Admin Credentials\n\nAdd these environment variables to your `.env` file:\n\n```env\nREACT_APP_SUPER_ADMIN_EMAIL=your-super-admin@company.com\nREACT_APP_SUPER_ADMIN_PASSWORD=YourSecurePassword123!\n```\n\n**IMPORTANT**: Change these default credentials immediately after setup!\n\n### 2. Initialize Super Admin Account\n\nRun the initialization function once during app setup:\n\n```typescript\nimport { initializeApp } from './lib/setup';\n\n// Call this once during app initialization\nawait initializeApp();\n```\n\n### 3. Deploy Firestore Rules\n\nThe updated Firestore rules include:\n- Super admin role with elevated permissions\n- Pending users collection for approval requests\n- Restricted user creation (super admin only)\n\n## User Registration Flow\n\n1. **User Request**: Users submit registration requests via `UserRegistrationRequest` component\n2. **Pending Status**: Requests are stored in `pending_users` collection\n3. **Super Admin Review**: Super admin reviews requests in `SuperAdminPanel`\n4. **Approval/Rejection**: Super admin approves (creates account) or rejects with reason\n5. **Account Creation**: Approved users get Firebase Auth account and user profile\n\n## Components\n\n### UserRegistrationRequest\n- Form for users to request account access\n- Submits to `pending_users` collection\n- No authentication required\n\n### SuperAdminPanel\n- Dashboard for super admin to manage requests\n- Approve/reject functionality\n- Password assignment for new users\n\n## Security Features\n\n- **Role Hierarchy**: super_admin > admin > staff\n- **Firestore Rules**: Enforce approval workflow at database level\n- **No Direct Signup**: Users cannot create accounts directly\n- **Audit Logging**: All approval actions are logged\n\n## API Methods\n\n```typescript\n// Request user creation (public)\nawait authService.requestUserCreation(email, name, role);\n\n// Approve user (super admin only)\nawait authService.approveUser(pendingUserId, password, approverUid);\n\n// Reject user (super admin only)\nawait authService.rejectUser(pendingUserId, reason, approverUid);\n\n// Get pending requests (super admin only)\nconst pending = await authService.getPendingUsers();\n\n// Check super admin status\nconst isSuperAdmin = await authService.isSuperAdmin(uid);\n```\n\n## Best Practices\n\n1. **Change Default Credentials**: Immediately update super admin email/password\n2. **Secure Environment**: Store credentials in environment variables, not code\n3. **Regular Review**: Periodically review and clean up pending requests\n4. **Strong Passwords**: Enforce strong password policy for approved users\n5. **Audit Monitoring**: Monitor approval actions for security\n\n## Troubleshooting\n\n- **Permission Denied**: Ensure Firestore rules are deployed\n- **Super Admin Not Found**: Run initialization script\n- **Environment Variables**: Check `.env` file configuration\n- **Firebase Auth**: Verify Firebase project configuration